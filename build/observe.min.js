!function(a){var b;b=function(){for(var b=0,c=["webkit","moz","ms","o"],d=a.requestAnimationFrame,e=a.cancelAnimationFrame,f=0;f<c.length&&!a.requestAnimationFrame;++f)d=a[c[f]+"RequestAnimationFrame"],e=a[c[f]+"CancelAnimationFrame"]||a[c[f]+"CancelRequestAnimationFrame"];return d||(d=function(c){var d=Date.now?Date.now():(new Date).getTime(),e=Math.max(0,16-(d-b)),f=a.setTimeout(function(){c(d+e)},e);return b=d+e,f}),e||(e=function(a){clearTimeout(a)}),{requestAnimationFrame:d,cancelAnimationFrame:e}}();var c;c=function(b){function c(a){return Object.prototype.toString.call(a)}function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function e(a){return Array.isArray?Array.isArray(a):"[object Array]"===c(a)}function f(a){return"[object Object]"===c(a)}function g(a){return Object(a)===a}function h(a){return"[object String]"===c(a)}function i(a){return"[object Function]"===c(a)}function j(a){return!isNaN(parseFloat(a))&&isFinite(a)}function k(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}function l(a){return f(a)&&("get"in a||"set"in a)}function m(a){return f(a)&&("value"in a||"writable"in a)}var n=a.setImmediate||b.requestAnimationFrame||a.setTimeout,o=a.clearImmediate||b.cancelAnimationFrame||a.clearTimeout,p={"default":{writable:!0,configurable:!0},hidden:{writable:!0,enumerable:!1,configurable:!0},immutable:{writable:!1,enumerable:!0,configurable:!1}},q=function(a,b,c,d){d=d||"default";var e={value:c},f=p[d].writable,g=p[d].enumerable,h=p[d].configurable;return null!=f&&(e.writable=f),null!=g&&(e.enumerable=g),null!=h&&(e.configurable=h),Object.defineProperty(a,b,e)};return{toString:c,isString:h,isArray:e,isObject:f,isObjectType:g,isCallable:i,isNumeric:j,isSameValue:k,isAccessorDescriptor:l,isDataDescriptor:m,hasOwn:d,nextTick:function(b){return n.call(a,b)},clearTick:function(b){return o.call(a,b)},oDef:q,createHash:function(){return Object.create(null)}}}(b);var d;d=function(){var a,b,c,d,e={};return"undefined"!=typeof WeakMap?a=WeakMap:(b="__weakmap:"+(1e9*Math.random()>>>0),c=(new Date).getTime()%1e9,a=function(){this.name=b+(1e9*Math.random()>>>0)+(c++ +"__")},a.prototype={has:function(a){return a&&Object.prototype.hasOwnProperty.call(a,this.name)},get:function(a){var b=a&&a[this.name];return b===e?void 0:b},set:function(a,b){Object.defineProperty(a,this.name,{value:"undefined"==typeof b?e:b,enumerable:!1,writable:!0,configurable:!0})},"delete":function(a){return delete a[this.name]}},d=Object.getOwnPropertyNames,Object.defineProperty(Object,"getOwnPropertyNames",{value:function(a){return d(a).filter(function(a){return 0===a.indexOf(b)})},writable:!0,enumerable:!1,configurable:!0})),a}();var e;e=function(a){return{observerCallbacks:[],notifierMap:new a,changeObserversMap:new a,activeChangesMap:new a,pendingChangesMap:new a,attachedNotifierCountMap:new a,watchedObjectMap:new a}}(d);var f;f=function(a,b){function c(){a.clearTick(r),r=a.nextTick(m)}function d(b){var c=this;if(a.isObject(c)||q("this","Object",c),c.__target){a.isObject(b)||q("changeRecord","Object",b);var d=b.type;a.isString(d)||q("changeRecord.type","String",d);var e=u.get(c);if(e&&0!==e.length){var f,g=c.__target,h={};a.oDef(h,"object",g,"immutable");for(f in b)"object"!==f&&a.oDef(h,f,b[f],"immutable");Object.preventExtensions(h),j(g,h)}}}function e(b,c){var d,e,h,i,k,l,m=this;if(a.isObject(m)||q("this","Object",m),d=m.__target){a.isString(b)||q("changeType","String",b),a.isCallable(c)||q("changeFn","Function",c),f(d,b);try{h=c.call(a.createHash())}catch(n){e=n}if(g(d,b),null!=e)throw e;if(h!==!1&&(i=u.get(m),i&&0!==i.length)){if(k={},a.oDef(k,"object",d,"immutable"),a.oDef(k,"type",b,"immutable"),null!=h)for(l in h)"object"!==l&&"type"!==l&&a.oDef(k,l,h[l],"immutable");Object.preventExtensions(k),j(d,k)}}}function f(a,b){var c=i(a),d=v.get(c),e=v.get(c)[b];d[b]="undefined"==typeof e?1:e+1}function g(a,b){var c=i(a),d=v.get(c),e=v.get(c)[b];d[b]=e>0?e-1:0}function h(a,b,c){var d=!1;if(b)for(var e=0,f=b.length;f>e;e++){var g=b[e];if(a[g]>0)return!1;g===c&&(d=!0)}return d}function i(a){if(!t.has(a)){var b=Object.create(y);Object.defineProperty(b,"__target",{value:a}),u.set(b,[]),v.set(b,{}),t.set(a,b)}return t.get(a)}function j(a,b){for(var d=i(a),e=b.type,f=v.get(d),g=u.get(d),j=0,k=g.length;k>j;j++){var l=g[j],m=l.accept;if(h(f,m,e)){var n=l.callback,o=[];w.has(n)?o=w.get(n):w.set(n,o),o.push(b)}}c()}function k(a){if(!x.get(a)&&!w.has(a)){x.delete(a);var b=s.indexOf(a);-1!==b&&s.splice(b,1)}}function l(b){var c,d=w.get(b);if(w.delete(b),!d||0===d.length)return!1;try{b.call(a.createHash(),d)}catch(e){c=e}finally{k(b)}if(null!=c)throw c;return!0}function m(){for(var a=s.slice(),b=!1,c=0,d=a.length;d>c;c++){var e=a[c];l(e)&&(b=!0)}return b}function n(b,c,d){var e,f;if(a.isObjectType(b)||q("target","ObjectType",b),a.isCallable(c)||q("observer","Function",c),Object.isFrozen(c))throw new TypeError("observer cannot be frozen");d=a.isArray(d)?d.filter(function(b){return a.isString(b)}):["add","update","delete","reconfigure","setPrototype","preventExtensions"],e=i(b),f=u.get(e);for(var g=0,h=f.length;h>g;g++)if(f[g].callback===c)return f[g].accept=d,b;return f.push({callback:c,accept:d}),-1===s.indexOf(c)&&s.push(c),x.has(c)?x.set(c,x.get(c)+1):x.set(c,1),b}function o(b,c){a.isObjectType(b)||q("target","ObjectType",b),a.isCallable(c)||q("observer","Function",c);for(var d=i(b),e=u.get(d),f=0,g=e.length;g>f;f++)if(e[f].callback===c){e.splice(f,1),x.set(c,x.get(c)-1),k(c);break}return b}function p(b){return a.isObjectType(b)||q("target","ObjectType",b),Object.isFrozen(b)?null:i(b)}function q(a,b,c){throw new TypeError(a+" must be one of ["+b+"], but received "+c)}var r,s=b.observerCallbacks,t=b.notifierMap,u=b.changeObserversMap,v=b.activeChangesMap,w=b.pendingChangesMap,x=b.attachedNotifierCountMap,y=Object.create(Object.prototype);return a.oDef(y,"notify",d,"hidden"),a.oDef(y,"performChange",e,"hidden"),{observe:n,unobserve:o,getNotifier:p}}(c,e);var g;g=function(a){function b(b){if(b=b||{},!a.isObject(b))throw new TypeError("[Batch initialize]: parameter need to be a object! But given "+b);var c=this.options={maxExecutingTime:null,iterateCount:1,allowDup:!0},d=b.onFlush;Object.keys(c).forEach(function(d){var e;if(a.hasOwn(b,d))switch(e=b[d],d){case"maxExecutingTime":if(!a.isNumeric(e))throw new TypeError('[Batch initialize options]: "maxExecutingTime" option need to be a numeric type, but given '+e);c[d]=10>e?10:Math.round(e);break;case"iterateCount":if(a.isNumeric(e))c[d]=1>e?1:Math.round(e);else{if("infinite"!==e)throw new TypeError('[Batch initialize options]: "iterateCount" option need to be a positive number or "infinite", but given '+e);c[d]=e}break;default:c[d]=e}}),this._cb=a.isCallable(d)?d:function(){},this._iterateCount=this.options.iterateCount,this._queue=[],this._startPos=0}return b.prototype.addTarget=function(a){var b=!!this.options.allowDup,c=this._queue.length;return this._iterateCount=this.options.iterateCount,b?this._queue.push(a):-1===this._queue.indexOf(a)&&this._queue.push(a),0===c&&1===this._queue.length&&this.scheduleFlush(),this},b.prototype.removeTarget=function(a){var b=this._queue.indexOf(a);return-1!==b&&this._queue.splice(b,1),this},b.prototype.flush=function(){var b,c,d,e,f=this.options.maxExecutingTime,g=!1,h=new Date,i=this._cb,j=this._startPos,k=this._iterateCount;for(e=this._queue,c=j,d=e.length;d>c;c++)if(b=e[c],i.call(null,b),f&&(g=new Date-h>f)){c++;break}1===k?(this._queue.splice(0,c),this._startPos=0):this._startPos=d>c?c:0,a.isNumeric(k)&&k>1&&0===this._startPos&&(this._iterateCount-=1),this._queue.length&&this.scheduleFlush()},b.prototype.scheduleFlush=function(){return this._tick=a.nextTick(function(a){return function(){return a.flush()}}(this)),this._tick},b.prototype.onFlush=function(b){if(!a.isCallable(b))throw new TypeError("[Batch.prototype.onFlush]need a Function here, but given "+b);return this._cb=b,this},b.prototype.length=function(){return this._queue.length},b.prototype.stop=function(b){return b?(this._queue=[],a.clearTick(this._tick)):(this._iterateCount=1,this._queue.splice(0,this._startPos),this._startPos=0),this},b}(c);var h;h=function(a,b){function c(b,c){return e(b),a.observe(b,c,["update","add","delete","splice"])}function d(b,c){return f(b),a.unobserve(b,c)}function e(a){return a.__mutateWatched__||(b.oDef(a,"__mutateWatched__",!0,"hidden"),i.forEach(function(c){b.oDef(a,c,j[c],"hidden")})),a}function f(a){return a.__mutateWatched__&&i.forEach(function(b){delete a[b]}),delete a.__mutateWatched__,a}function g(c){b.oDef(j,c,function(){var b,d,e,f,g,i,j=Array.prototype[c],k=this,l=a.getNotifier(this),m=k.length;return b=Array.prototype.slice.call(arguments),d=b.length,f=[],g=[],l.performChange("splice",function(){var a;switch(c){case"push":e=m,f=h(m,m+d-1);break;case"unshift":e=0,f=h(0,d-1);break;case"pop":e=m-1,g=[m-1];break;case"shift":e=0,g=[0];break;case"splice":a=b[0]<0?m+b[0]:b[0],a=0>a?0:a,e=a,1===d?g=h(a,m-1):2===d?b[1]>0&&(g=h(a,a+b[1]-1)):(b[1]>0&&(g=h(a,a+b[1]-1)),f=h(a,a+b.slice(2).length-1))}return i=j.apply(k,b),k.length!==m?{method:c,inserted:f,removed:g,index:e}:!1}),i})}function h(a,b){var c,d,e;for(e=[],c=d=a;b>=a?b>=d:d>=b;c=b>=a?++d:--d)e.push(c);return e}var i=["splice","pop","shift","unshift","push"],j=Object.create(Array.prototype);return i.forEach(g),{observe:c,unobserve:d}}(f,c);var i;i=function(a,b,c,d,e){function f(b){var c=a.getNotifier(b);return i.has(c)||(i.set(c,{properties:[],values:[]}),h(b,!0),j.addTarget(b)),b}function g(c,d){var e,f,g,h,j=Object.getOwnPropertyDescriptor(c,d),k=a.getNotifier(c);return"getNotifier"===d||b.isAccessorDescriptor(j)||!j.enumerable?!1:(g=i.get(k),f=g.properties,e=g.values,f.push(d),e.push(c[d]),h=e[e.length-1],b.isArray(c)&&b.isNumeric(d)||Object.defineProperty(c,d,{enumerable:!0,configurable:!0,get:function(){return h},set:function(a){b.isSameValue(a,h)||(k.notify({type:"update",name:d,oldValue:h}),e[e.length-1]=a)}}),!0)}function h(c,d){var e,f,h,j,k,l,m=a.getNotifier(c),n=Object.keys(c),o=i.get(m),p=o.properties,q=o.values,r=p.slice(0),s=!d,t=b.isArray(c);for(t&&-1===p.indexOf("length")&&(p.push("length"),q.push(c.length)),e=0,f=n.length;f>e;e++)h=n[e],j=c[h],-1===(k=p.indexOf(h))?g(c,h)&&s&&m.notify({type:"add",name:h}):(t&&b.isNumeric(h)&&(b.isSameValue(q[k],j)||(s&&m.notify({type:"update",name:h,oldValue:q[k]}),q[k]=j)),r.splice(r.indexOf(h),1));if(s){for(t&&r.splice(r.indexOf("length"),1),f=r.length,e=0;f>e;e++)k=p.indexOf(r[e]),m.notify({type:"delete",name:r[e],oldValue:q[k]}),p.splice(k,1),q.splice(k,1);t&&(k=p.indexOf("length"),l=q[k],l!==c.length&&(m.notify({type:"update",name:"length",oldValue:l}),q[k]=c.length))}}var i=c.watchedObjectMap,j=new d({maxExecutingTime:100,iterateCount:"infinite",allowDup:!1,onFlush:h});return restore=function(c){var d,e,f=a.getNotifier(c),g=i.get(f),h=g.properties,k=g.values;if(!b.isArray(c))for(d=0,e=h.length;e>d;d++)b.oDef(c,h[d],k[d]);return i["delete"](f),j.removeTarget(c),c},{observe:Object.observe||function(b,c,d){return f(b),a.observe(b,c,d),b},unobserve:Object.unobserve||function(b,c){return a.unobserve(b,c),restore(b),b},getNotifier:Object.getNotifier||a.getNotifier,ArrayObserve:e.observe,ArrayUnobserve:e.unobserve}}(f,c,e,g,h),"undefined"!=typeof module&&module.exports?module.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):(c.oDef(Object,"observe",i.observe),c.oDef(Object,"unobserve",i.unobserve),c.oDef(Object,"getNotifier",i.getNotifier),c.oDef(Array,"observe",i.ArrayObserve),c.oDef(Array,"unobserve",i.ArrayUnobserve))}("undefined"!=typeof window?window:this);